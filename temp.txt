{
    "_links": {
        "authReversal": {
            "method": "POST",
            "href": "/pts/v2/payments/7231143450116559104951/reversals"
        },
        "self": {
            "method": "GET",
            "href": "/pts/v2/payments/7231143450116559104951"
        },
        "capture": {
            "method": "POST",
            "href": "/pts/v2/payments/7231143450116559104951/captures"
        }
    },

    "clientReferenceInformation": {
        "code": "ADP_CB-1723110729737-3F4082D418CB92AE"
    },

    "consumerAuthenticationInformation": {
        "token": "Axj/7wSTiABGP6QaGmu3AKUs3ZM2LFozaNWDFi2atXLFg0ctWKe/D1DDbAKe/D1DDbdsFqg+wyaSZejFsY7VAnJxAAjH9INDTXbgczsj"
    },

    "id": "7231143450116559104951",

    "orderInformation": {
        "amountDetails": {
            "authorizedAmount": "21",
            "currency": "XAF"
        }
    },

    "paymentAccountInformation": {
        "card": {
            "type": "001"
        }
    },

    "paymentInformation": {
        "tokenizedCard": {
            "type": "001"
        },
        "card": {
            "type": "001"
        }
    },

    "processorInformation": {
        "systemTraceAuditNumber": "129042",
        "approvalCode": "831000",
        "merchantAdvice": {
            "code": "01",
            "codeRaw": "M001"
        },
        "responseDetails": "ABC",
        "networkTransactionId": "016153570198200",
        "retrievalReferenceNumber": "422110129042",
        "consumerAuthenticationResponse": {
            "code": "2",
            "codeRaw": "2"
        },
        "transactionId": "016153570198200",
        "responseCode": "00",
        "avs": {
            "code": "Y",
            "codeRaw": "Y"
        }
    },
    "reconciliationId": "7231143450116559104951",
    "status": "AUTHORIZED",
    "submitTimeUtc": "2024-08-08T10:52:25Z"
}

######################## FAIL AUTHORIZATION MESSAGE ########################
{
  _links: {
    authReversal: {
      method: "POST",
      href: "/pts/v2/payments/7231336018256497404989/reversals",
    },
    self: {
      method: "GET",
      href: "/pts/v2/payments/7231336018256497404989",
    },
    capture: {
      method: "POST",
      href: "/pts/v2/payments/7231336018256497404989/captures",
    },
  },
  clientReferenceInformation: {
    code: "ADP_CB-1723129986116-D7B818B6911A55E0",
  },
  consumerAuthenticationInformation: {
    token: "Axj/7wSTiALyY1gSLuw9AKUs3ZM2LNm2YMXDJq2aOW7Rg0cuHKfyNIJ75gKfyNIJ759sKlhB9Xh0ky9GLYx2qD6TiALyY1gSLuw9AAAAxxE1",
  },
  errorInformation: {
    reason: "DECISION_PROFILE_REJECT",
    message: "The order has been rejected by Decision Manager",
  },
  id: "7231336018256497404989",
  orderInformation: {
    amountDetails: {
      authorizedAmount: "600",
      currency: "XAF",
    },
  },
  paymentInformation: {
    accountFeatures: {
      category: "F",
      group: "0",
    },
    scheme: "VISA PREPAID",
    bin: "41876210",
    accountType: "Visa Classic",
    issuer: "UNITED BANK FOR AFRICA CAMEROON",
    binCountry: "CM",
  },
  processorInformation: {
    approvalCode: "291614",
    networkTransactionId: "304221584023087",
    retrievalReferenceNumber: "422116482616",
    transactionId: "304221584023087",
    responseCode: "00",
    avs: {
      code: "U",
      codeRaw: "U",
    },
  },
  reconciliationId: "7231336018256497404989",
  riskInformation: {
    localTime: "17:13:21",
    score: {
      result: "30",
      factorCodes: [ "G" ],
      modelUsed: "default_cemea",
    },
    infoCodes: {
      address: [ "UNV-ADDR" ],
      suspicious: [ "RISK-SD" ],
      identityChange: [ "ID-M-NoHistory" ],
      internet: [ "FREE-EM" ],
    },
    profile: {
      earlyDecision: "ACCEPT",
    },
    casePriority: "3",
  },
  status: "AUTHORIZED_RISK_DECLINED",
  submitTimeUtc: "2024-08-08T16:13:22Z",
}


############################################################
#                       SERVICE SETUP                      #
############################################################
SETUP_SERVICE_REQUEST = {
  "clientReferenceInformation": {
    "code": "cybs_test",
    "partner": {
      "developerId": "7891234",
      "solutionId": "89012345"
    }
  },
  "paymentInformation": {
    "card": {
      "type": "001",
      "expirationMonth": "12",
      "expirationYear": "2025",
      "number": "4000000000000101"
    }
  }
}

SETUP_SERVICE_RESPONSE = {

  "clientReferenceInformation": {
    "code": "cybs_test",
    "partner": {
      "developerId": "7891234",
      "solutionId": "89012345"
    }
  },

  "consumerAuthenticationInformation": {
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJhZTQ4YjNlZi00ZjdmLTQxZmQtODgyMi1lNDZmYzZjM2RkNDYiLCJpYXQiOjE3MjM2MzI2MDAsImlzcyI6IjVkZDgzYmYwMGU0MjNkMTQ5OGRjYmFjYSIsImV4cCI6MTcyMzYzNjIwMCwiT3JnVW5pdElkIjoiNWI5YzRiYjNmZjYyNmIxMzQ0ODEwYTAxIiwiUmVmZXJlbmNlSWQiOiI0M2YxZWJlNi0yMmJjLTQ0OGEtOTZkMC1kY2U3ZDRiNWYzNTMifQ.xoumPYWUq0DOE-ewKyNwDzmKMI2PW_MXdLrEG4VwbwA",
    "deviceDataCollectionUrl": "https://centinelapistag.cardinalcommerce.com/V1/Cruise/Collect",
    "referenceId": "43f1ebe6-22bc-448a-96d0-dce7d4b5f353",
    "token": "AxizbwSTiEgyYAuD0SAZABEBTyDV8qSgAhBwyaSZejFczCmAMAAAYwp8"
  },

  "id": "7236326003016283004953",
  "status": "COMPLETED",
  "submitTimeUtc": "2024-08-14T10:50:00Z"
}

********* SUCCESS ********
{
  "clientReferenceInformation": {
    "code": "ADP_CB-1723646192105-78FA57E42CCC5AFA"
  },
  "consumerAuthenticationInformation": {
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI4OTliNzRjMS0yMmE2LTQ2YmMtODMyNi1mOWY1ZTE4MzM0NTAiLCJpYXQiOjE3MjM2NDk4MDIsImlzcyI6IjVkZDgzYmYwMGU0MjNkMTQ5OGRjYmFjYSIsImV4cCI6MTcyMzY1MzQwMiwiT3JnVW5pdElkIjoiNjQyZDliYjkyYmEyNDcyZDAzZGM1NWM0IiwiUmVmZXJlbmNlSWQiOiI2ZTFmZDc2Ni0yYWVlLTQzYTYtYWEwMy05NWM4NWUxYTQ1YWYifQ.tDO_sq0Ch_UPUjp49seP0ehyMcMn2IkYQZ9IMudqPf4",
    "deviceDataCollectionUrl": "https://centinelapistag.cardinalcommerce.com/V1/Cruise/Collect",
    "referenceId": "6e1fd766-2aee-43a6-aa03-95c85e1a45af",
    "token": "AxizbwSTiEqVgkc8jEx5AKUBT34fqb2kAhBwyaSZejFsY7UAKAAAXA56"
  },
  "id": "7236498021866950904953",
  "status": "COMPLETED",
  "submitTimeUtc": "2024-08-14T15:36:42Z"
}

############ DEVICE COLLECT RES ##############
{
  "MessageType":"profile.completed",
  "SessionId":"f05c6f85-5341-4753-9ee1-ca44f6c5fbd0",
  "Status":true
}



#################################
#    EXAMPLE MESSAGE ON FAILURE #
#################################
Authentication Failed
Your card issuer cannot authenticate this card. Please select another card or form of payment to
complete your purchase.

*********** FAILURE ************
{
  "id":"7236513232016201304951",
  "submitTimeUtc":"2024-08-14T16:02:03Z",
  "status":"INVALID_REQUEST",
  "reason":"INVALID_ACCOUNT",
  "message":"Decline - Invalid account number"
}

############################################################
#                         WEBHOOKS                         #
############################################################

* generate shared key under Payment Configuration > Key Management.

* webhooks end-points to call: 
- test:  POST apitest.cybersource.com/kms/egress/v2/keys-sym
- prod:  POST api.cybersource.com/kms/egress/v2/keys-sym

*hearders: 


############### CHECK ENROLLMENT REQUEST ####################
{
  "clientReferenceInformation": {
    "code": "cybs_test"
  },
  "orderInformation": {
    "amountDetails": {
      "currency": "USD",
      "totalAmount": "10.99"
    },
    "billTo": {
      "address1": "1 Market St",
      "address2": "Address 2",
      "administrativeArea": "CA",
      "country": "US",
      "locality": "san francisco",
      "firstName": "John",
      "lastName": "Doe",
      "phoneNumber": "4158880000",
      "email": "test@cybs.com",
      "postalCode": "94105"
    }
  },
  "paymentInformation": {
    "card": {
      "type": "001",
      "expirationMonth": "12",
      "expirationYear": "2025",
      "number": "4000000000000101"
    }
  },
  "buyerInformation": {
    "mobilePhone": 1245789632
  },
  "deviceInformation": {
    "httpAcceptBrowserValue": "",
    "httpAcceptContent": "",
    "httpBrowserLanguage": "",
    "httpBrowserJavaEnabled": false,
    "httpBrowserJavaScriptEnabled": false,
    "httpBrowserColorDepth": "",
    "httpBrowserScreenHeight": "",
    "httpBrowserScreenWidth": "",
    "httpBrowserTimeDifference": "",
    "userAgentBrowserValue": ""
  },
  "consumerAuthenticationInformation": {
    "transactionMode": "eCommerce"
  }
}


############### CHECK ENROLLMENT SUCCESS RESONSE ####################
*****AUTHENTICATION_SUCCESSFUL******
{
  "clientReferenceInformation": {
      "code": "ADP_CB-1723806572299-E3112D6DFC6FE068"
  },
  "consumerAuthenticationInformation": {
      "eciRaw": "05",
      "authenticationTransactionId": "SCUjfLIYGlTqnPa6ing0",
      "strongAuthentication": {
          "OutageExemptionIndicator": "0"
      },
      "effectiveAuthenticationType": "FR",
      "authorizationPayload": "eyJjb250YWluZXJWZXJzaW9uIjoiMSIsImVjaSI6IjA1IiwiYXV0aGVudGljYXRpb25WYWx1ZSI6IkFKa0JCa2hnUVFBQUFFNGdTRUp5ZFFBQUFBQT0iLCJlZmZlY3RpdmVBdXRoVHlwZSI6IkZSIiwiYWNzT3BlcmF0b3JJRCI6Ik1lcmNoYW50QUNTIiwidGhyZWVEU1JlcXVlc3RvckNoYWxsZW5nZUluZCI6IjAxIiwidHJhbnNTdGF0dXMiOiJZIiwiZHNUcmFuc0lEIjoiOGRlYTVmMDctMTZhOS00YmEzLWI4ODQtNzJjZDIzNzhlZTdjIiwiYWNzVHJhbnNJRCI6IjU0NjY2Zjg5LTJmZmUtNGRkMS04MGE0LWU0ZTMwMGRiYTFjZSIsIm1lc3NhZ2VWZXJzaW9uIjoiMi4xLjAiLCJtZXJjaGFudE5hbWUiOiJGSUNUSUY4IiwicHVyY2hhc2VEYXRlIjoiMjAyNDA4MTYxMjA5NTIiLCJwdXJjaGFzZUFtb3VudCI6IjIwMDAiLCJicm93c2VySVAiOiIxNDUuMjI0LjcyLjEzMyIsIm1lcmNoYW50Q291bnRyeUNvZGUiOiIxMjAiLCJhY3F1aXJlckJJTiI6IjQ2OTIxNiIsImFjcXVpcmVyTWVyY2hhbnRJRCI6IjQ0NDQ0MDAwMDgiLCJ0aHJlZURTUmVxdWVzdG9yTmFtZSI6IkZJQ1RJRjgiLCJ0aHJlZURTUmVxdWVzdG9ySUQiOiIxMDA1MjIzNio2NDJkOWJiOTJiYTI0NzJkMDNkYzU1YzQiLCJjYXJkQnJhbmQiOiJWSVNBIn0=",
      "eci": "05",
      "token": "AxjzbwSTiGDXtCzvMhk5AKUBT34gIrNHthf0EIWGTSTL0YtjHagBQAAA9Bk9",
      "cavv": "AJkBBkhgQQAAAE4gSEJydQAAAAA=",
      "paresStatus": "Y",
      "acsReferenceNumber": "Cardinal ACS",
      "xid": "AJkBBkhgQQAAAE4gSEJydQAAAAA=",
      "directoryServerTransactionId": "8dea5f07-16a9-4ba3-b884-72cd2378ee7c",
      "veresEnrolled": "Y",
      "threeDSServerTransactionId": "4df764ff-e3d1-4304-8427-f7162a32e462",
      "acsOperatorID": "MerchantACS",
      "ecommerceIndicator": "vbv",
      "specificationVersion": "2.1.0",
      "acsTransactionId": "54666f89-2ffe-4dd1-80a4-e4e300dba1ce"
  },
  "id": "7238101921146862704953",
  "paymentInformation": {
      "card": {
          "bin": "400000",
          "type": "VISA"
      }
  },
  "status": "AUTHENTICATION_SUCCESSFUL",
  "submitTimeUtc": "2024-08-16T12:09:52Z"
}

############### CHECK ENROLLMENT FAILED RESONSE ####################
*****AUTHENTICATION_FAILED******
{
    "clientReferenceInformation": {
        "code": "ADP_CB-1723807124453-F87F2B60238D125C"
    },
    "consumerAuthenticationInformation": {
        "eciRaw": "07",
        "authenticationTransactionId": "8Z43T3Rzis4DpLuZ1Pe0",
        "strongAuthentication": {
            "OutageExemptionIndicator": "0"
        },
        "effectiveAuthenticationType": "FR",
        "authorizationPayload": "eyJjb250YWluZXJWZXJzaW9uIjoiMSIsImVmZmVjdGl2ZUF1dGhUeXBlIjoiRlIiLCJhY3NPcGVyYXRvcklEIjoiTWVyY2hhbnRBQ1MiLCJ0aHJlZURTUmVxdWVzdG9yQ2hhbGxlbmdlSW5kIjoiMDEiLCJ0cmFuc1N0YXR1cyI6Ik4iLCJ0cmFuc1N0YXR1c1JlYXNvbiI6IjAxIiwiZHNUcmFuc0lEIjoiNjgyMzhmZDItODQzNS00ZWU2LWEyZjgtY2IwMTIwM2U2MjQ0IiwiYWNzVHJhbnNJRCI6IjE1ZTRiYjU5LWVlOTMtNDBiOS04Nzk1LTliOGVkNWY2ZWJhYyIsIm1lc3NhZ2VWZXJzaW9uIjoiMi4xLjAiLCJtZXJjaGFudE5hbWUiOiJGSUNUSUY4IiwicHVyY2hhc2VEYXRlIjoiMjAyNDA4MTYxMjE5MTMiLCJwdXJjaGFzZUFtb3VudCI6IjIwMDAiLCJicm93c2VySVAiOiIxNDUuMjI0LjcyLjEzMyIsIm1lcmNoYW50Q291bnRyeUNvZGUiOiIxMjAiLCJhY3F1aXJlckJJTiI6IjQ2OTIxNiIsImFjcXVpcmVyTWVyY2hhbnRJRCI6IjQ0NDQ0MDAwMDgiLCJ0aHJlZURTUmVxdWVzdG9yTmFtZSI6IkZJQ1RJRjgiLCJ0aHJlZURTUmVxdWVzdG9ySUQiOiIxMDA1MjIzNio2NDJkOWJiOTJiYTI0NzJkMDNkYzU1YzQiLCJjYXJkQnJhbmQiOiJWSVNBIn0=",
        "signedParesStatusReason": "01",
        "token": "AxjzbwSTiGDroK9JHWo5AKUBT34gIwuXthf0EIVdzSTL0YtjHagDgAAA9Be3",
        "cardholderMessage": "Note: Additional authentication is required by the issuing bank for this transaction, please contact �nyb�nk at 123-456-7890.",
        "paresStatus": "N",
        "acsReferenceNumber": "Cardinal ACS",
        "directoryServerTransactionId": "68238fd2-8435-4ee6-a2f8-cb01203e6244",
        "veresEnrolled": "Y",
        "threeDSServerTransactionId": "a9a1e343-7530-4a53-b6f5-2c0b25802cdd",
        "acsOperatorID": "MerchantACS",
        "specificationVersion": "2.1.0",
        "acsTransactionId": "15e4bb59-ee93-40b9-8795-9b8ed5f6ebac"
    },
    "errorInformation": {
        "reason": "CONSUMER_AUTHENTICATION_FAILED",
        "message": "Encountered a Payer Authentication problem. Payer could not be authenticated."
    },
    "id": "7238107529216018704953",
    "paymentInformation": {
        "card": {
            "bin": "400000",
            "type": "VISA"
        }
    },
    "status": "AUTHENTICATION_FAILED",
    "submitTimeUtc": "2024-08-16T12:19:13Z"
}

############### CHECK_ENROLLMENT_PENDING_RESPONSE ####################
*****PENDING_AUTHENTICATION******
{
  "clientReferenceInformation": {
      "code": "ADP_CB-1723807570722-56546DB7D5D599AE"
  },
  "consumerAuthenticationInformation": {
    "challengeRequired": "N",
    "authenticationTransactionId": "VUqgzbmKhLTF0xCkJD20",
    "strongAuthentication": {
        "OutageExemptionIndicator": "0"
    },
    "token": "AxjzbwSTiGD7H5Brc/wXAKUBT34gI0u7thf0EIVdrSTL0YtjHagDgAAA5BdX",
    "acsUrl": "https://0merchantacsstag.cardinalcommerce.com/MerchantACSWeb/creq.jsp",
    "acsReferenceNumber": "Cardinal ACS",
    "stepUpUrl": "https://centinelapistag.cardinalcommerce.com/V2/Cruise/StepUp",
    "pareq": "eyJtZXNzYWdlVHlwZSI6IkNSZXEiLCJtZXNzYWdlVmVyc2lvbiI6IjIuMS4wIiwidGhyZWVEU1NlcnZlclRyYW5zSUQiOiIwZmUxNmE1Yi1iN2YwLTRhNGUtYmMyOC1mMDcwYTVkMjQ2YmEiLCJhY3NUcmFuc0lEIjoiZWE4OGZjN2QtYzNiOS00NmI0LTk1ZjgtYTVhNThlN2I0ODk4IiwiY2hhbGxlbmdlV2luZG93U2l6ZSI6IjAyIn0",
    "directoryServerTransactionId": "bd03ad31-26c1-4a0e-88e8-8e57899ef840",
    "veresEnrolled": "Y",
    "threeDSServerTransactionId": "0fe16a5b-b7f0-4a4e-bc28-f070a5d246ba",
    "acsOperatorID": "MerchantACS",
    "specificationVersion": "2.1.0",
    "acsTransactionId": "ea88fc7d-c3b9-46b4-95f8-a5a58e7b4898"
  },
  "errorInformation": {
    "reason": "CONSUMER_AUTHENTICATION_REQUIRED",
    "message": "The cardholder is enrolled in Payer Authentication. Please authenticate the cardholder before continuing with the transaction."
  },
  "id": "7238111890846078204951",
  "paymentInformation": {
    "card": {
      "bin": "400000",
      "type": "VISA"
    }
  },
  "status": "PENDING_AUTHENTICATION",
  "submitTimeUtc": "2024-08-16T12:26:29Z"
}

{
  "status": "PENDING_AUTHENTICATION",
  "challenge": true,
  "challengeWindowSize": {
      "width": 390,
      "height": 400
  },
  "clientReferenceInformation": {
      "code": "ADP_CB-1723823558772-30EFA2BD042E4B88"
  },
  "consumerAuthenticationInformation": {
      "token": "AxjzbwSTiGMzPY24GwgZAKUBT34gL/Uzthf0EIVdrSTL0YtjHagEAAAA/QfX",
      "acsUrl": "https://0merchantacsstag.cardinalcommerce.com/MerchantACSWeb/creq.jsp",
      "stepUpUrl": "https://centinelapistag.cardinalcommerce.com/V2/Cruise/StepUp",
      "acsTransactionId": "15a99949-df7e-4e90-ae36-f827b50e656f"
  }
}
